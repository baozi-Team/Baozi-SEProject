!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("previewImage requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a){function d(){return navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)?!1:!0}var c,d,e,f,g;try{if("Microsoft Internet Explorer"==navigator.appName&&parseInt(navigator.appVersion.split(";")[1].replace(/[ ]/g,"").replace("MSIE",""))<=9)return console.log("您的浏览器版本过低，请使用IE9以上版本"),!1}catch(b){}return c={},d=d(),e=d?"overflow: auto;":"",f="#__previewImage-container{-ms-touch-action:none;touch-action:none;-webkit-touch-action:none;line-height:100vh;background-color:#000;width:100vw;height:100vh;position:fixed;overflow:hidden;top:0;left:0;bottom:0;z-index: 2147483647;transition:transform .2s;-ms-transition:transform .2s;-moz-transition:transform .2s;-webkit-transition:transform .2s;-o-transition:transform .2s;transform:translate3d(100%,0,0);-webkit-transform:translate3d(100%,0,0);-ms-transform:translate3d(100%,0,0);-o-transform:translate3d(100%,0,0);-moz-transform:translate3d(100%,0,0)}#__previewImage-container .previewImage-text{position:absolute;top:.6em;text-align:center;font-size:18px;line-height:25px;color:#fff;z-index:10;padding: 0.2em 0.4em;background-color: rgba(255,255,255,0.4);border-radius: 50%;letter-spacing: 0;right:.8em}#__previewImage-container .previewImage-text .previewImage-text-index{font-size: 24px;}#__previewImage-container .previewImage-box{width:999999rem;height:100vh}#__previewImage-container .previewImage-box .previewImage-item{width:100vw;height:100vh;margin-right:15px;float:left;text-align:center;background:rgba(0,0,0,0.8);display:flex;align-items:center;"+e+"}#__previewImage-container .previewImage-box .previewImage-item.previewImage-nobackground{background:none}#__previewImage-container .previewImage-box .previewImage-item .previewImage-image{vertical-align:middle;width:100%;background:#fff;}.previewImage-close{position:absolute;top:.8em;text-align:center;line-height:25px;color:#fff;z-index:10;padding:4px;background-color: rgba(255,255,255,1);border-radius: 50%;right:.8em}.previewImage-closeIcon{background: url(//image.wjx.com/images/commonImgPC/del@2x.png) no-repeat;background-size: cover;width: 18px;height: 18px;display:block}",c.isArray=function(a){return"[object Array]"==Object.prototype.toString.call(a)},c.all=function(a,b){var c,d=[];return c=b?b.querySelectorAll(a):document.querySelectorAll(a),c&&c.length>0&&(d=Array.prototype.slice.call(c)),d},c.delegate=function(a,b,d,e){a&&a.addEventListener(b,function(b){var g,h,f=c.all(d,a);if(f)for(g=0;g<f.length;g++)for(h=b.target;h;){if(h==f[g]){e.call(h,b);break}if(h=h.parentNode,h==a)break}},!1)},g=function(){this.winw=a.innerWidth||document.documentElement.clientWidth,this.winh=document.documentElement.clientHeight,this.originWinw=this.winw,this.originWinh=this.winh,this.marginRight=15,this.imageChageMoveX=this.marginRight+this.winw,this.imageChageNeedX=Math.floor(.5*this.winw),this.cssprefix=["","webkit","Moz","ms","o"],this.version="1.0.3",this.imgLoadCache=new Object,this.scale=1,this.maxScale=10,this.maxOverScale=20,this.openTime=.3,this.slipTime=.5,this.maxOverWidthPercent=.5,this.$box=!1,this.isPreview=!1;var b=document.createElement("style");b.innerText=f,b.type="text/css",this.$container=document.createElement("div"),this.$container.id="__previewImage-container",this.$container.style.width=this.winw+"px",this.$container.style.height=this.winh+"px",document.body.appendChild(this.$container),document.head.appendChild(b),this.bind()},g.prototype.start=function(a){var f,g,h,b=a.urls,d=a.current,e=a.close;if(d&&(f=d.split(",w_"),2==f.length&&(d=f[0]+",w_1200"),g=d.split(",h_200"),1==g.length&&(g=d.split(",h_400")),2==g.length&&(d=g[0]+g[1])),this.$container.innerHTML="",!b||!c.isArray(b)||0==b.length){if(!d)throw new Error("urls must be a Array and the minimum length more than zero");b=[d]}d?(h=b.indexOf(d),0>h&&(h=0),this.index=h):this.index=0,this.close=e,this.urls=b,this.maxLen=b.length-1,this.cIndex=this.maxLen+1,this.bIndex=this.maxLen+2,this.imgStatusCache=new Object,this.render()},g.prototype.render=function(){var c,d,e,f,b=this;this.$box===!1?(c=document.createElement("div"),c.className+="previewImage-box",this.$box=c):this.$box.innerHTML="",d=document.createElement("div"),this.$close=d,this.$close.className+="previewImage-close",this.$close.innerHTML="<span class='previewImage-closeIcon'></span>",e=document.createElement("div"),this.$text=e,this.$text.className+="previewImage-text",this.$text.innerHTML="<span class='previewImage-text-index'>"+(this.index+1)+"/</span>"+(this.maxLen+1),this.container=this.imgStatusCache[this.cIndex]={elem:this.$container,x:this.winw,y:0,m:0,my:0,scale:1,scalem:1},this.box=this.imgStatusCache[this.bIndex]={elem:this.$box,x:0,y:0,m:0,my:0,scale:1,scalem:1},this.urls.forEach(function(c,d){var g,e=document.createElement("div"),f=a.md5?md5(c+d):c+d,h=b.imgLoadCache[f];h&&h.isload?(g=h.elem,g.height*b.winw/g.width>b.winh&&(e.style.display="block"),e.className+=" previewImage-nobackground"):(g=new Image,g.className+="previewImage-image",b.imgLoadCache[f]={isload:!1,elem:g},d==b.index&&(g.src=c,g.onload=function(){g.height*b.winw/g.width>b.winh&&(e.style.display="block"),e.className+=" previewImage-nobackground",b.imgLoadCache[f].isload=!0})),b.imgStatusCache[d]={hash:f,x:0,m:0,y:0,my:0,scale:b.scale,scalem:1},e.className+=" previewImage-item",e.appendChild(g),b.$box.appendChild(e)}),this.$container.appendChild(this.$box),this.close?this.$container.appendChild(this.$close):this.$container.appendChild(this.$text),f=-this.imageChageMoveX*this.index,this.box.x=f,this.container.x=0,this.$container.style.display="block",setTimeout(function(){b.translateScale(b.bIndex,0),b.translateScale(b.cIndex,b.openTime),b.isPreview=!0},50)},g.prototype.bind=function(){var b=this.$container,d=this,e=function(){d.closePreview.call(d)},f=function(){d.touchStartFun.call(d)},g=function(){d.touchMoveFun.call(d)},h=function(){d.touchEndFun.call(d)},i=function(){var c,b=this;b.winw=a.innerWidth||document.documentElement.clientWidth,b.winh=document.documentElement.clientHeight,b.originWinw=b.winw,b.originWinh=b.winh,b.$container.style.width=b.winw+"px",b.$container.style.height=b.winh+"px",b.imageChageMoveX=b.marginRight+b.winw,c=-b.imageChageMoveX*b.index;try{b.box.x=c,b.translateScale(b.bIndex,0)}catch(d){}}.bind(this);a.addEventListener("resize",i,!1),c.delegate(b,"click",".previewImage-item",e),c.delegate(b,"click",".previewImage-close",e),c.delegate(b,"touchstart",".previewImage-item",f),c.delegate(b,"touchmove",".previewImage-item",g),c.delegate(b,"touchend",".previewImage-item",h),c.delegate(b,"touchcancel",".previewImage-item",h)},g.prototype.closePreview=function(){var a=this;this.imgStatusCache[this.cIndex].x=this.winw,this.translateScale(this.cIndex,this.openTime),this.imgStatusRewrite(),this.translateScale(this.index,this.slipTime),setTimeout(function(){a.$container.style.display="none"},1e3*this.slipTime),a.isPreview=!1},g.prototype.touchStartFun=function(){this.ts=this.getTouches(),this.allowMove=!0,this.statusX=0,this.statusY=0},g.prototype.touchMoveFun=function(){var b,c;this.tm=this.getTouches(),b=this.tm,c=this.ts,this.moveAction(c,b)},g.prototype.touchEndFun=function(){this.$container,this.te=this.getTouches(),this.endAction(this.ts,this.te)},g.prototype.moveAction=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(this.allowMove)if(c=this.getIndexImage(),e=.3*this.winw/c.scale,f=b.x0-a.x0,g=b.y0-a.y0,Math.abs(g)>0&&event.preventDefault(),h=c.x+f,i=c.y+g,j=this.getAllow(this.index),k=this.allowX=j.x,l=this.allowY=j.y0,0>=f&&(this.allowX=-k),0>=g&&(l=this.allowY=j.y1),1==b.length)if(c.scale>1)if(i>=j.y0?(this.statusY=1,m=i-j.y0,c.my=j.y0-c.y+this.getSlowlyNum(m,e)):i<=j.y1?(this.statusY=1,m=i-j.y1,c.my=j.y1-c.y+this.getSlowlyNum(m,e)):(this.statusY=2,c.my=g),0>f&&c.x<=-k)this.statusX=1,this.box.m=f,this.index==this.maxLen&&(this.box.m=this.getSlowlyNum(f)),this.translateScale(this.bIndex,0),this.translateScale(this.index,0);else if(f>0&&c.x>=k)this.statusX=2,this.box.m=f,0==this.index&&(this.box.m=this.getSlowlyNum(f)),this.translateScale(this.bIndex,0),this.translateScale(this.index,0);else{if(0==f)return;this.statusX=3,c.m=f,h>=k&&(this.statusX=4,n=h-k,c.m=k-c.x+this.getSlowlyNum(n,e)),-k>=h&&(this.statusX=4,n=h+k,c.m=-k-c.x+this.getSlowlyNum(n,e)),this.translateScale(this.index,0)}else if(Math.abs(g)>5&&5!=this.statusX&&!d)o=this.getJqElem(this.index),p=o.height-this.winh,g>0&&i>0?(this.statusX=7,this.allowY=0,o.height>this.winh&&(c.my=-c.y+this.getSlowlyNum(i,e))):0>g&&-p>i?(this.statusX=7,o.height>this.winh?(m=i+p,this.allowY=-p,c.my=-p-c.y+this.getSlowlyNum(m,e)):this.allowY=0):(this.statusX=6,c.my=g),this.translateScale(this.index,0);else{if(6==this.statusX)return;this.statusX=5,this.box.m=0==this.index&&f>0||this.index==this.maxLen&&0>f?this.getSlowlyNum(f):f,this.translateScale(this.bIndex,0)}else q=this.getScale(a,b),r=q*c.scale,r>=this.maxScale&&(s=r-this.maxScale,r=this.maxScale+this.getSlowlyNum(s,this.maxOverScale),q=r/c.scale),c.scalem=q,this.translateScale(this.index,0)},g.prototype.endAction=function(a,b){var f,g,h,i,j,c=this.getIndexImage(),d=b.x0-a.x0;if(b.y0-a.y0,f=b.time-a.time,g=0,this.allowMove=!1,1==a.length){switch(Math.abs(d)>10&&event.preventDefault(),this.statusY){case 1:c.y=this.allowY,c.my=0,g=this.slipTime;break;case 2:c.y=c.y+c.my,c.my=0}switch(this.statusX){case 1:this.index!=this.maxLen&&(d<=-this.imageChageNeedX||200>f&&-30>d)?this.changeIndex(1):(this.changeIndex(0),0!=g&&this.translateScale(this.index,g));break;case 2:0!=this.index&&(d>=this.imageChageNeedX||200>f&&d>30)?this.changeIndex(-1):(this.changeIndex(0),0!=g&&this.translateScale(this.index,g));break;case 3:c.x=c.x+c.m,c.m=0,this.translateScale(this.index,g);break;case 4:c.x=this.allowX,c.m=0,g=this.slipTime,this.translateScale(this.index,g);break;case 5:d>=this.imageChageNeedX||200>f&&d>30?this.changeIndex(-1):d<=-this.imageChageNeedX||200>f&&-30>d?this.changeIndex(1):this.changeIndex(0);break;case 6:c.y=c.y+c.my,c.my=0;break;case 7:c.y=this.allowY,c.my=0,this.translateScale(this.index,this.slipTime)}}else event.preventDefault(),h=c.scale*c.scalem,i=this.getJqElem(this.index),c.scale=h,j=this.getAllow(this.index),c.x>j.x?(g=this.slipTime,c.x=j.x):c.x<-j.x&&(g=this.slipTime,c.x=-j.x),c.y>j.y0?(g=this.slipTime,c.y=j.y0):c.y<j.y1&&(g=this.slipTime,c.y=j.y1),i.height*c.scale<=this.winh&&(c.y=0),i.width*c.scale<=this.winw&&(c.x=0),c.scalem=1,h>this.maxScale?(c.scale=this.maxScale,g=this.slipTime):1>h&&(this.imgStatusRewrite(),g=this.slipTime),0!=g&&(this.changeIndex(0),this.translateScale(this.index,g))},g.prototype.getAllow=function(a){var e,f,b=this.getJqElem(a),c=this.getIndexImage(a),d=Math.floor((b.width*c.scale-this.winw)/(2*c.scale));return b.height*c.scale<=this.winh?(e=0,f=0):b.height<=this.winh?(e=Math.floor((b.height*c.scale-this.winh)/(2*c.scale)),f=-e):(e=Math.floor(b.height*(c.scale-1)/(2*c.scale)),f=-Math.floor((b.height*(c.scale+1)-2*this.winh)/(2*c.scale))),{x:d,y0:e,y1:f}},g.prototype.getSlowlyNum=function(a,b){var b=b||this.winw*this.maxOverWidthPercent;return 0>a?(a=-a,-(1-a/(b+a))*a):(1-a/(b+a))*a},g.prototype.getScale=function(a,b){var c=Math.sqrt(Math.pow(a.x1-a.x0,2)+Math.pow(a.y1-a.y0,2)),d=Math.sqrt(Math.pow(b.x1-b.x0,2)+Math.pow(b.y1-b.y0,2)),e=d/c;return e},g.prototype.imgStatusRewrite=function(a){var b;a=void 0===a?this.index:a,b=this.imgStatusCache[a],b.x=0,b.y=0,b.m=0,b.my=0,b.scale=1,b.scalem=1,a!=this.index&&this.translateScale(a,this.slipTime)},g.prototype.changeIndex=function(a){var c,d,e,f;this.getIndexImage(),c=this.index,d=this,0==this.index&&-1==a?this.index=this.index:this.index==this.maxLen&&1==a?this.index=this.index:(this.index+=a,this.$text.innerHTML="<span class='previewImage-text-index'>"+(this.index+1)+"/</span>"+(this.maxLen+1),e=this.imgStatusCache[this.index].hash,f=this.imgLoadCache[e],f.isload?(f.elem.height*d.winw/f.elem.width>d.winh&&(f.elem.parentNode.style.display="block"),-1==f.elem.parentNode.className.indexOf("previewImage-nobackground")&&(f.elem.parentNode.className+=" previewImage-nobackground")):(f.elem.src=this.urls[this.index],f.elem.onload=function(){f.elem.height*d.winw/f.elem.width>d.winh&&(f.elem.parentNode.style.display="block"),-1==f.elem.parentNode.className.indexOf("previewImage-nobackground")&&(f.elem.parentNode.className+=" previewImage-nobackground"),f.isload=!0})),this.box.x=-this.imageChageMoveX*this.index,this.box.m=0,c!=this.index&&this.imgStatusRewrite(c),this.translateScale(this.bIndex,this.slipTime)},g.prototype.getIndexImage=function(a){var a=void 0==a?this.index:a;return this.imgStatusCache[this.index]},g.prototype.translateScale=function(a,b){var d,e,f,g,h,c=this.imgStatusCache[a];$elem=this.getJqElem(a),d=c.scale*c.scalem,e=c.x+c.m,f=c.y+c.my,g="scale("+d+","+d+") "+" translate("+e+"px,"+f+"px)",h="transform "+b+"s ease-out",this.addCssPrefix($elem,"transition",h),this.addCssPrefix($elem,"transform",g)},g.prototype.getJqElem=function(a){var b,c,d,e;return a=void 0==a?this.index:a,a<=this.maxLen?(c=this.imgStatusCache[a].hash,d=this.imgLoadCache[c].elem,b=d):(e=this.imgStatusCache[a].elem,b=e),b},g.prototype.addCssPrefix=function(a,b,c){var d,e,f;for(d in this.cssprefix)if(e=this.cssprefix[d],""===e?b=b.toLowerCase():(f=b.length,b=b.substr(0,1).toUpperCase()+b.substr(1,f).toLowerCase()),void 0!==document.body.style[b])return a.style[b]=c,void 0},g.prototype.getTouches=function(){var b=event.touches.length>0?event.touches:event.changedTouches,c={touches:b,length:b.length};return c.x0=b[0].pageX,c.y0=b[0].pageY,c.time=(new Date).getTime(),b.length>=2&&(c.x1=b[0].pageX,c.y1=b[1].pageY),c},a.previewImage=new g,"function"==typeof define&&define.amd&&define([],function(){return previewImage}),previewImage});